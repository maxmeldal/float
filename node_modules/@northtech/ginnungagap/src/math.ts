/**
 * Calculates the average (mean) of a series of numbers
 */
export function mean(data: Iterable<number>): number {
  let count = 0;
  let mean = 0;
  for (const n of data) {
    count++;
    mean += (n - mean) / count;
  }
  return count == 0
    ? Number.NaN
    : mean;
}

/**
 * Calculates the standard deviation of a series of numbers.
 */
export function standardDeviation(data: Iterable<number>): number {
  const m = mean(data);
  if (Number.isNaN(m)) {
    return Number.NaN;
  }
  let count = 0;
  let squaredDiff = 0;
  for (const n of data) {
    count++;
    squaredDiff += (n - m) ** 2;
  }
  return Math.sqrt(squaredDiff / count);
}

// Some day, we should include something like https://medium.com/@nxtchg/calculating-median-without-sorting-eaa639cedb9f
